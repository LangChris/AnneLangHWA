<div *ngIf="!admin.orders || admin.orders.length == 0" class="centered-block">
  <p>No orders placed yet.</p>
</div>

<div *ngIf="admin.orders && admin.orders.length > 0"> 
  <div class="centered-block">
    <div class="header">Orders</div>
    <table>
      <tr>
        <th>Filter</th>
        <td>
          <select id="filter" (change)="filter()">
            <option value="all">All Orders</option>
            <option value="last-7-days">Last 7 Days</option>
            <option value="last-30-days">Last 30 Days</option>
            <option value="last-60-days">Last 60 Days</option>
            <option value="last-90-days">Last 90 Days</option>
          </select>
        </td>
      </tr>
      <tr>
        <th>Sort</th>
        <td>
          <select id="sort" (change)="sort()">
            <option value="ASC">Oldest to Newest</option>
            <option value="DESC">Newest to Oldest</option>
          </select>
        </td>
      </tr>
    </table>
  </div>
  <p>Results: {{admin.orders.length}}</p>
  <table class="table" #TABLE>  
    <thead>  
      <tr>  
        <th>Name</th>  
        <th>Email</th>  
        <th>Plan</th>
        <th>Years</th>
        <th>Home Type</th>
        <th>Address</th>
        <th>Buyer Name</th>
        <th>Buyer Email</th>
        <th>Seller Name</th>
        <th>Seller Email</th>
        <th>Close/Start Date</th>
        <th>Optional Coverage</th>
        <th>Hvac Coverage</th>
        <th>Realtor Name</th>
        <th>Realtor Email</th>
        <th>Title Agent Email</th>
        <th>Promo</th>
      </tr>  
    </thead>  
    <tbody>  
      <tr *ngFor="let order of admin.orders" id="{{order.id}}" (mouseenter)="showOrderEntered(true, order.id)" (mouseleave)="showOrderEntered(false, order.id)" >  
        <td data-th="Name">
          <div class="top-wrapper"><span style="display: none" id="order-entered-{{order.id}}" class="check order-entered" (click)="orderEntered(order.id)" ></span></div>
          <div class="bottom-wrapper">{{order.name}}</div>
        </td>  
        <td data-th="Email">{{order.email}}</td>
        <td data-th="Plan">{{formatOrder(order.plan)}}</td>
        <td data-th="Years">{{formatOrder(order.years)}}</td>
        <td data-th="Home Type">{{formatOrder(order.home_type)}}</td>
        <td data-th="Address">{{formatOrder(order.address_line)}}<br />&nbsp;{{formatOrder(order.city)}},{{formatOrder(order.state)}} {{formatOrder(order.zip)}}</td>
        <td data-th="Buyer Name">{{formatOrder(order.buyer_name)}}</td>
        <td data-th="Buyer Email">{{formatOrder(order.buyer_email)}}</td>
        <td data-th="Seller Name">{{formatOrder(order.seller_name)}}</td>
        <td data-th="Seller Email">{{formatOrder(order.seller_email)}}</td>
        <td data-th="Close/Start Date">{{formatOrder(order.close_start_date)}}</td>
        <td data-th="Optional Coverage">{{formatOrder(order.optional_coverage)}}</td>
        <td data-th="Hvac Coverage">{{formatOrder(order.hvac_coverage)}}</td>
        <td data-th="Realtor Name">{{formatOrder(order.realtor_name)}}</td>
        <td data-th="Realtor Email">{{formatOrder(order.realtor_email)}}</td>
        <td data-th="Title Agent Email">{{formatOrder(order.title_agent_email)}}</td>
        <td data-th="Promo">{{formatOrder(order.promo)}}</td>
      </tr>  
    </tbody>  
  </table> 
  <div class="centered-block top-padding">
    <button class="export" (click)="ExportToExcel()"></button>  
    <button class="top-margin home" (click)="admin.updateDisplay(false, false, true);"></button>
  </div>
</div> 