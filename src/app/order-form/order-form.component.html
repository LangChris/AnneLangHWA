<div class="centered-block">
  <div class="header">{{global.settings.webpageTitle}}</div>
  <div class="sub-header">{{global.settings.webpageSubTitle}}</div>
  <p *ngIf="showForm">{{global.settings.orderDescription}}</p>
  <app-promo *ngIf="showForm"></app-promo>
  <div class="section" *ngIf="!showForm">{{global.settings.orderMessage}}</div>
  <div class="section" *ngIf="showForm">
    <progress value={{progressStep}} max=4></progress>
    
      <form id="orderForm" [formGroup]="orderForm" novalidate (ngSubmit)="submitOrder()" >
        
        <div class="popout" [hidden]="progressStep != 1">
          <div class="circle" (click)="toggleHelpClicked()"><span class="help"></span></div>
          <p class="popout-header">Let's start with you...</p>
          <p *ngIf="helpClicked" class="popout-subheader">Enter Login Credentials or select Guest Checkout to continue.</p>
          <p *ngIf="helpClicked" class="popout-subheader">We need to know who is filling out the form in order to get back in contact.</p>
          <table class="double-section">
            <tr>
              <td class="section-box" id="login-register-box" (click)="toggleActive('LOGIN')">
                <p class="popout-header-double top-margin"><span id="login-text" (click)="togglePanel('LOGIN')">Login</span> / <span id="register-text" (click)="togglePanel('REGISTER')">Register</span></p>
                <p *ngIf="helpClicked && panel == 'REGISTER'" class="popout-subheader">For faster checkout create an account</p>
                <p *ngIf="helpClicked && panel == 'LOGIN'" class="popout-subheader">Login to keep track of your orders</p>
                <hr width="50%" color="#ddd" />
                <table class="order-form" *ngIf="panel == 'LOGIN'">
                  <tr>
                    <th class="required">Email/Username*</th>
                    <td>
                      <input type="text" class="large" id="login-username" (change)="isLoginActive()"/>
                      <span *ngIf="global.loginStatus == 'BAD_USER'" class="required small-text" ><br /> Email/Username not found!</span>
                    </td>
                  </tr>
                  <tr>
                    <th class="required">Password*</th>
                    <td>
                      <input type="password" class="large" id="login-password" (change)="isLoginActive()" />
                      <span *ngIf="global.loginStatus == 'BAD_PASS'" class="required small-text" ><br /> Password is Invalid!</span>
                      <span *ngIf="global.loginStatus == 'SUCCESS'" class="success small-text" ><br /> Successful login, proceed Next</span>
                    </td>
                  </tr>
                  <tr *ngIf="global.loginStatus != 'SUCCESS'">
                    <th></th>
                    <td>
                      <span class="button" (click)="login()">Login</span>
                    </td>
                  </tr>
                </table>
                <table class="order-form" *ngIf="panel == 'REGISTER'">
                  <tr>
                    <th class="required">Name*</th>
                    <td>
                      <input type="text" class="large" id="register-name"/>
                    </td>
                  </tr>
                  <tr>
                    <th class="required">Email*</th>
                    <td>
                      <input type="email" class="large" id="register-email" />
                      <span *ngIf="global.registerStatus == 'BAD_EMAIL'" class="required small-text" ><br /> Email is already registered!</span>
                    </td>
                  </tr>
                  <tr>
                    <th>Username</th>
                    <td>
                      <input type="text" class="large" id="register-username" />
                      <span *ngIf="global.registerStatus == 'BAD_USER'" class="required small-text" ><br /> Username is already registered!</span>
                    </td>
                  </tr>
                  <tr>
                    <th class="required">Password*</th>
                    <td>
                      <input type="password" class="large" id="register-password" />
                      <span *ngIf="global.registerStatus == 'BAD_PASS'" class="required small-text" ><br /> Password is required!</span>
                      <span *ngIf="global.registerStatus == 'SUCCESS'" class="success small-text" ><br /> Successful registration, proceed Next</span>
                      <span *ngIf="global.registerStatus == 'SERVER_ERROR'" class="required small-text" ><br /> Server Error, Please try again</span>
                    </td>
                  </tr>
                  <tr *ngIf="global.registerStatus != 'SUCCESS'">
                    <th></th>
                    <td>
                      <span class="button" (click)="registerUser()">Register</span>
                    </td>
                  </tr>
                </table>
              </td>
              <td class="section-box" id="guest-checkout-box" (click)="toggleActive('GUEST')">
                <p class="popout-header-double top-margin">Guest Checkout</p>
                <p *ngIf="helpClicked" class="popout-subheader">Checkout as a guest</p>
                <hr width="50%" color="#ddd" />
            <table class="order-form">
              <tr>
                <th class="required">Name*</th>
                <td>
                  <input type="text" class="large" id="name" name="name" formControlName="name"/>
                  <span *ngIf="validateName && !orderForm.controls.name.valid" class="required small-text" ><br /> Name is Required!</span>
                </td>
              </tr>
              <tr>
                <th class="required">Email*</th>
                <td>
                  <input type="email" class="large" id="email" name="email" formControlName="email"/>
                  <span *ngIf="validateEmail && !orderForm.controls.email.valid" class="required small-text" ><br /> Email is Invalid!</span>
                </td>
              </tr>
            </table>
              </td>
            </tr>
          </table>  
        </div>

        <div class="popout" [hidden]="progressStep != 2">
          <div class="circle" (click)="toggleHelpClicked()"><span class="help"></span></div>
          <p class="popout-header">What property do you need coverage for?</p>
          <p *ngIf="helpClicked" class="popout-subheader">We need to know the type of home, and the street address of the property you need coverage for as pricing varies.</p>
          <hr width="50%" color="#ddd" />
            <table class="order-form">
              <tr>
                <th>Home Type</th>
                <td>
                  <input type="radio" name="homeType" id="home-type-sf" value="SINGLE_FAMILY_HOME" formControlName="homeType" checked/>Single Family Home<br />
                  <input type="radio" name="homeType" id="home-type-th" value="TOWNHOME_CONDO" formControlName="homeType" />Townhome/Condo</td>
              </tr>
              <tr>
                <th>Address Line</th>   
                <td><input type="text" class="large" id="address-line" name="addressLine" maxlength="200" formControlName="addressLine"/></td>   
              </tr>
              <tr>
                <th>City</th>   
                <td><input type="text" class="medium" id="city" name="city" maxlength="50" formControlName="city"/> State <input type="text" class="small" id="state" name="state" maxlength="2" formControlName="state"/></td>   
              </tr>
              <tr>
                <th>Zip</th>   
                <td><input type="text" class="medium" id="zip" name="zip" maxlength="5" formControlName="zip"/></td>   
              </tr>
              <tr>
                <th class="group-header">Special Request(Quote Needed)</th>
              </tr>
              <tr *ngFor="let request of global.specialRequests; let i = index">
                <th class="group-label">{{request.request}}</th>
                <td>
                  <div class="checkbox">
                    <input type="checkbox" value="None" id="special-request-{{i}}" name="specialRequest{{i}}"/>
                    <label for="special-request-{{i}}"></label>
                  </div>
                </td>
              </tr>
            </table>
        </div>

        <div class="popout" [hidden]="progressStep != 3">
          <div class="circle" (click)="toggleHelpClicked()"><span class="help"></span></div>
          <p class="popout-header">Select your coverage options:</p>
          <p *ngIf="helpClicked" class="popout-subheader">Select an available plan and plan length, any additional coverages you need, and closing date or start date of coverage.</p>
          <hr width="50%" color="#ddd" />
            <table class="order-form">
              <tr>
                <th>Plan</th>
                <td>
                    <select id="plan" name="plan" formControlName="plan">
                        <option selected>Select One</option>
                        <option value="GOLD">Gold</option>
                        <option value="PLATINUM">Platinum</option>
                        <option value="DIAMOND">Diamond</option>
                    </select>  
                </td>
              </tr>
              <tr>
                <th>Years</th>
                <td>
                  <select id="years" name="years" formControlName="years">
                    <option value="13 Months" selected>13 Months</option>
                    <option value="2 Years">2 Years</option>
                    <option value="3 Years">3 Years</option>
                  </select>
                </td>
              </tr>
              <tr>
                <th>Optional Coverage</th>
                <td>
                    <div class="multi-select large" id="multi-select"></div>
                    <select id="optional-coverage" name="optionalCoverage" formControlName="optionalCoverage" multiple hidden></select>  
                </td>
              </tr>
              <tr>
                <th class="required">Close/Start Date*</th>   
                <td>
                  <input type="date" class="large" id="close-start-date" name="closeStartDate" formControlName="closeStartDate"/>
                  <span *ngIf="validateDate && !orderForm.controls.closeStartDate.valid" class="required small-text" ><br /> Close/Start Date is Required!</span>
                </td>   
              </tr>
              <tr>
                <th>Promo</th>   
                <td><input type="text" class="medium" id="promo" name="promo" formControlName="promo" (keydown)="updatePromoStatus($event)" (paste)="updatePromoStatus($event)"/><span id="promo-status"></span></td>   
              </tr>
            </table>
        </div>

        <div class="popout" [hidden]="progressStep != 4">
          <div class="circle" (click)="toggleHelpClicked()"><span class="help"></span></div>
          <p class="popout-header">Buyer/Realtor info</p>
          <p *ngIf="helpClicked" class="popout-subheader">If you have any buyer, realtor, or title agent info please enter it below.</p>
          <hr width="50%" color="#ddd" />
            <table class="order-form">
              <tr>
            <th class="group-header">Buyer</th>
          </tr>
          <tr>
            <th class="group-label">Name</th>   
            <td><input type="text" class="large" id="buyer-name" name="buyerName" formControlName="buyerName"/></td>   
          </tr>
          <tr>
            <th class="group-label">Email</th>   
            <td><input type="email" class="large" id="buyer-email" name="buyerEmail" formControlName="buyerEmail"/></td>   
          </tr>
          <tr>
            <th class="group-label">Phone</th>   
            <td><input type="tel" class="large" id="buyer-phone" name="buyerPhone" formControlName="buyerPhone"/></td>   
          </tr>
        <tr>
          <th class="group-header">Referring Realtor</th>
        </tr>
        <tr>
          <th class="group-label">Name</th>   
          <td><input type="text" class="large" id="realtor-name" name="realtorName" formControlName="realtorName"/></td>   
        </tr>
        <tr>
          <th class="group-label">Email</th>   
          <td><input type="email" class="large" id="realtor-email" name="realtorEmail" formControlName="realtorEmail"/></td>   
        </tr>
        <tr>
          <th class="group-label">Company</th>   
          <td><input type="text" class="large" id="realtor-company" name="realtorCompany" formControlName="realtorCompany"/></td>   
        </tr>
        <tr>
          <th class="group-label">Office Zip</th>   
          <td><input type="text" class="medium" id="realtor-zip" name="realtorZip" maxlength="5" formControlName="realtorZip"/></td>   
        </tr>
        <tr>
          <th>Title Agent Email</th>   
          <td><input type="email" class="large" id="title-agent-email" name="titleAgentEmail" formControlName="titleAgentEmail"/></td>   
        </tr>
            </table>
        </div>
       
        <table class="navigation">
          <tr>
            <td class="left"><span [hidden]="progressStep == 1 || progressStep == 2" class="button extra-pad top-margin back" (click)="makeProgressStep('PREV')"> Back</span></td>
            <td class="right"><span [hidden]="progressStep == 4 || 
              (active == 'GUEST' && (!orderForm.controls.name.valid || !orderForm.controls.email.valid)) || 
              (active == 'LOGIN' && global.loginStatus != 'SUCCESS') || 
              (active == 'REGISTER' && global.registerStatus != 'SUCCESS')" class="button extra-pad top-margin next" (click)="makeProgressStep('NEXT')"> Next</span></td>
          </tr>
        </table>
      
    <div class="header order-total">Order Total: ${{total}}</div>
    <button [hidden]="progressStep < 4" class="top-margin" type="submit" form="orderForm">PLACE ORDER</button>
  </form>
  <p class="required extra-padding">* Field is required</p>
  </div>
